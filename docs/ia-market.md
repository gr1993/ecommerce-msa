# 마켓 IA 문서

고객용 화면/기능 구조를 실제 구현 기준으로 정리한 문서입니다.

---

## 1. 인증 (Auth-Service / User-Service)

### 1-1. 회원가입

- 이메일 입력 (유효성 검사)
- 비밀번호 입력 (최소 8자, 영문 대소문자 + 숫자 포함)
- 비밀번호 확인 (일치 검증)
- 이름 입력 (최소 2자)
- 연락처 입력 (선택, 010-xxxx-xxxx 형식)
- 회원가입 완료 후 로그인 페이지로 이동

### 1-2. 로그인

- 이메일 / 비밀번호 입력
- JWT 토큰 디코딩 및 사용자 정보 추출
- 로그인 상태 저장 (Zustand authStore)
- 로그인 후 원래 페이지 또는 메인으로 리다이렉트

---

## 2. 상품 (Catalog-Service)

### 2-1. 상품 목록

- 상품 목록 조회 (페이지네이션)
- 카테고리 필터링 (3단계 계층 구조)
- 상품명 검색 (자동완성, 300ms debounce)
- 자동완성 키보드 네비게이션 (위 / 아래 / Enter / Escape)
- 정렬 (최신순 / 낮은 가격순 / 높은 가격순)
- 페이지당 표시 수 선택 (8 / 12 / 16개)
- 상품 카드 (이미지, 이름, 기본가격, 할인가격, 할인율)
- URL 파라미터로 검색 상태 유지

### 2-2. 상품 상세

- 상품 정보 조회 (productId 기반)
- 이미지 갤러리 (썸네일 선택)
- 옵션 그룹별 선택 (다중 옵션 지원)
- 선택한 옵션 조합에 맞는 SKU 매칭
- 옵션별 재고 확인
- 수량 조절 (최소 1개, 최대 재고 수량)
- 총 금액 계산
- 장바구니 담기
- 바로 구매 (주문 페이지로 이동)
- 옵션별 재고 현황 테이블

---

## 3. 장바구니 (Local State)

- 장바구니 아이템 목록 표시
- 전체 선택 / 해제
- 개별 아이템 선택 / 해제
- 수량 조절 (+ / - 버튼, 직접 입력)
- 선택 아이템 삭제
- 아이템별 / 전체 금액 계산
- 선택한 아이템만 주문하기

---

## 4. 주문 / 결제 (Order-Service / Payment-Service)

### 4-1. 주문

- 3단계 프로세스 (배송지 정보 → 주문 확인 → 결제)
- 배송지 정보 입력 (받는 분, 연락처, 우편번호, 주소, 상세주소, 배송 메모)
- 사용 가능 쿠폰 조회 및 선택
- 자동 할인 정책 조회 및 적용
- 총 금액 / 할인금액 / 최종금액 계산
- 주문 생성
- 토스페이먼츠 결제 요청
- 결제 정보 임시 저장 (pendingOrderStore)

### 4-2. 결제 승인

- 결제 파라미터 파싱 (paymentKey, orderId, amount)
- 주문번호 / 금액 검증
- 결제 승인 API 호출
- 결제 성공 시 장바구니에서 해당 상품 제거
- 주문 완료 페이지로 이동

### 4-3. 결제 실패

- 결제 실패 파라미터 파싱 (code, message, orderId)
- 에러 코드별 한글 메시지 표시
- 임시 주문 정보 삭제
- 다시 주문하기 / 장바구니로 돌아가기

### 4-4. 주문 완료

- 주문번호 / 결제번호 / 영수증번호 / 결제금액 표시
- 쇼핑 계속하기 / 홈으로 이동

---

## 5. 마이페이지

### 5-1. 주문 내역 (Order-Service)

- 주문 목록 조회 (페이지네이션, 페이지당 수 조절)
- 주문 상태 표시
- 주문 취소 (CREATED / PAID 상태에서만)
- 취소 사유 입력

### 5-2. 배송 조회 (Shipping-Service)

- 배송 목록 조회 (페이지네이션)
- 배송 상태 표시
- 배송사 / 운송장 번호 표시
- 운송장 번호 복사
- 배송 추적 (CJ대한통운 / 한진택배)
- 배송 상세 모달

### 5-3. 반품 / 교환 (Shipping-Service / Order-Service)

- 반품 신청 가능 배송 목록 조회 (배송 완료 건만)
- 반품 신청 (반품 사유 선택, 상세 사유 입력)
- 반품 내역 조회
- 반품 상세 모달 (상태, 사유, 거절 사유, 운송장, 수거지 주소)
- 교환 신청 (교환할 상품 선택, 새 옵션 / SKU 선택, 수량 입력)

### 5-4. 쿠폰 (Promotion-Service)

- 쿠폰 코드 등록
- 쿠폰 목록 조회 (사용 가능 / 사용 완료 / 만료됨 탭)
- 쿠폰 상세 모달 (할인 내용, 사용 조건, 유효기간)
- 쿠폰 코드 복사 (사용 가능한 쿠폰만)

---
